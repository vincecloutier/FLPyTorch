2024-11-09 13:10:37,989 INFO Results after 25 global rounds of training model resnet:
2024-11-09 13:10:37,989 INFO Avg Train Accuracy: 70.0%
2024-11-09 13:10:37,989 INFO Test Accuracy: 68.97999999999999%
2024-11-09 13:10:37,989 INFO Total Run Time: 1999.9920530319214
2024-11-10 10:39:18,037 INFO Results after 10 global rounds of training model mnist in 1 setting:
2024-11-10 10:39:18,037 INFO Avg Train Accuracy: 95.0%
2024-11-10 10:39:18,037 INFO Test Accuracy: 97.39%
2024-11-10 10:39:18,037 INFO Total Run Time: 292.36892199516296
2024-11-10 11:04:17,381 INFO Results after 10 global rounds of training model mnist in 0 setting:
2024-11-10 11:04:17,381 INFO Avg Train Accuracy: 72.0%
2024-11-10 11:04:17,381 INFO Test Accuracy: 76.51%
2024-11-10 11:04:17,381 INFO Total Run Time: 262.7168071269989
2024-11-10 12:04:13,956 INFO Results after 10 global rounds of training model mnist in mislabeled with 1 mislabeled sample proportion per client and 0.5 bad clients proportion:
2024-11-10 12:04:13,957 INFO Test Accuracy: 44.91%
2024-11-10 12:04:13,957 INFO Total Run Time: 309.73111724853516

2024-11-10 15:45:56,516 INFO Number Of Users: 50, Fraction Of Clients Per Round: 0.5, Number Of Rounds: 5, Local Epochs: 5
2024-11-10 15:45:56,516 INFO Dataset: mnist, Setting: Non-IID w/ 4 categories per bad client and 25 bad clients
2024-11-10 15:45:56,516 INFO Test Accuracy Before Retraining: 94.28999999999999%
2024-11-10 15:45:56,516 INFO Test Accuracy After Retraining: 93.39%
2024-11-10 15:45:56,516 INFO Bad Client Accuracy: 0.58
2024-11-10 15:45:56,516 INFO Banzhaf Values: defaultdict(<class 'float'>, {21: 1.5593217611312866, 26: 0.8443001955747604, 11: 1.484209083020687, 2: 2.006855998188257, 38: 0.06395305693149567, 40: -0.0656459853053093, 27: 1.2721315175294876, 25: 1.072314739227295, 6: 0.9383574873209, 19: 1.3536293171346188, 43: 0.1271231770515442, 1: 1.6830078065395355, 13: 1.6238886564970016, 41: 0.6249018609523773, 32: 0.18735569715499878, 28: 0.9965667128562927, 42: 0.40087611973285675, 16: 0.5896217301487923, 30: 0.7636246532201767, 35: 0.8006850183010101, 24: 1.7515125572681427, 22: 1.0088534876704216, 3: 0.37714409828186035, 45: 0.0793762095272541, 48: 1.4491274845786393, 37: 1.5258598327636719, 7: 1.1022913604974747, 29: 0.9039617031812668, 12: 1.533772274851799, 23: 2.703156476840377, 9: 1.120021402835846, 14: 1.0078197717666626, 34: 0.8581853955984116, 4: 0.961572527885437, 5: 2.1931928247213364, 33: 1.2797013111412525, 31: 1.8555488586425781, 17: 1.2770822048187256, 18: 0.5412649065256119, 46: 0.32070645689964294, 15: 0.9501636624336243, 39: 0.32497021555900574, 8: 0.38213662058115005, 44: 0.7432532906532288, 0: 0.1715751737356186, 47: 0.9930600002408028})
2024-11-10 15:45:56,516 INFO Predicted Bad Clients: [38, 40, 43, 41, 32, 42, 16, 3, 45, 18, 46, 39, 8, 0] vs. Actual Bad Clients: [25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2024-11-10 15:45:56,516 INFO Total Run Time: 512.1225152015686

2024-11-10 18:19:45,712 INFO Number Of Users: 50, Fraction Of Clients Per Round: 0.5, Number Of Rounds: 10, Local Epochs: 3
2024-11-10 18:19:45,712 INFO Dataset: mnist, Setting: Non-IID w/ 4 categories per bad client and 15 bad clients
2024-11-10 18:19:45,712 INFO Test Accuracy Before Retraining: 95.66%
2024-11-10 18:19:45,712 INFO Test Accuracy After Retraining: 95.67%
2024-11-10 18:19:45,712 INFO Bad Client Accuracy: 0.54
2024-11-10 18:19:45,712 INFO Banzhaf Values: defaultdict(<class 'float'>, {49: 1.446215383708477, 40: 0.5437935814261436, 29: 0.2595201665535569, 42: 0.5483849536976777, 47: 1.0549755073152483, 10: 1.1597354970872402, 45: 0.5727298740530387, 0: 1.715512603521347, 44: 1.4958701860159636, 11: 0.35414824541658163, 8: 0.8424271494150162, 26: 1.5118738040328026, 17: 0.7658232944086194, 46: 0.5752013698220253, 30: 0.6050216555595398, 35: 0.5433430392295122, 34: 0.47498431988060474, 25: 2.6983328387141228, 20: 0.10365947801619768, 41: 1.6932371445000172, 27: 1.769956503296271, 33: 1.8229214642196894, 12: 0.9875715561211109, 37: -0.2714017555117607, 19: 2.2516998946666718, 16: 0.7588190529495478, 13: 1.9504828825592995, 38: 1.6993253859691322, 48: 0.9959325864911079, 6: 1.6989162894897163, 4: 1.6309894025325775, 22: 1.3406571105588228, 23: 1.6725258957594633, 18: 1.789085440337658, 15: 1.2076548524200916, 5: 2.4600519947707653, 1: 1.5797877311706543, 7: 1.417237751185894, 28: 0.26653772965073586, 3: -0.26520821638405323, 21: 0.41816782054957, 32: 0.6752536296844482, 2: 0.03016973054036498, 36: 0.2274302989244461, 43: 0.2551995273679495, 9: -0.3693392276763916, 39: 0.664660070091486, 24: -0.06995769776403904, 14: 0.6294667646288872, 31: 0.10768421553075314})
2024-11-10 18:19:45,712 INFO Predicted Bad Clients: [29, 11, 34, 20, 37, 28, 3, 21, 2, 36, 43, 9, 24, 31] vs. Actual Bad Clients: [35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2024-11-10 18:19:45,712 INFO Total Run Time: 634.0595510005951

2024-11-11 08:21:22,229 INFO Number Of Users: 50, Fraction Of Clients Per Round: 0.6, Number Of Rounds: 10, Local Epochs: 3
2024-11-11 08:21:22,229 INFO Dataset: mnist, Setting: Mislabeled with 40.0% mislabeled sample percentage per bad client and 15 bad clients
2024-11-11 08:21:22,229 INFO Test Accuracy Before Retraining: 96.81%
2024-11-11 08:21:22,229 INFO Test Accuracy After Retraining: 96.67%
2024-11-11 08:21:22,229 INFO Bad Client Accuracy: 0.96
2024-11-11 08:21:22,229 INFO Banzhaf Values: defaultdict(<class 'float'>, {16: 1.0792470797896385, 40: -1.0968435555696487, 14: 2.8057001382112503, 48: -0.7471347749233246, 19: 1.2713271751999855, 47: -1.0686401724815369, 10: 0.813790999352932, 25: 1.976158581674099, 34: 0.9808428138494492, 1: 2.63799287378788, 46: -1.0136169288307428, 7: 2.049524746835232, 9: 1.4552934765815735, 27: 0.8937680944800377, 15: 2.19565237686038, 26: 2.1567105315625668, 21: 2.2866989821195602, 33: 2.1098178178071976, 3: 2.4995881244540215, 43: -1.0303025394678116, 42: -1.514080798253417, 20: 0.9721036553382874, 37: -0.9623189717531204, 39: -0.828811451792717, 44: -1.073414795100689, 36: -1.1796324700117111, 31: 2.319886915385723, 12: 2.1122469305992126, 13: 1.4770482406020164, 30: 2.4674062207341194, 35: -1.7797986790537834, 28: 1.3180097974836826, 5: 2.131261885166168, 24: 2.0523788407444954, 23: 1.7308766581118107, 2: 2.116093497723341, 18: 1.46772750467062, 38: -1.4992502331733704, 49: -1.0383088439702988, 17: 2.4042729660868645, 11: 1.5622149407863617, 29: 2.2605713456869125, 4: 1.2251981124281883, 8: 0.9286957234144211, 32: 0.9639619141817093, 0: 0.9166155308485031, 22: 0.26582326740026474, 45: -1.0337051153182983, 41: -1.0616147369146347, 6: 0.3156023994088173})
2024-11-11 08:21:22,229 INFO Predicted Bad Clients: [40, 48, 47, 46, 43, 42, 37, 39, 44, 36, 35, 38, 49, 22, 45, 41, 6] vs. Actual Bad Clients: [35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2024-11-11 08:21:22,229 INFO Total Run Time: 777.0498960018158

2024-11-11 09:13:12,352 INFO Number Of Clients: 50, Fraction Of Clients Per Round: 0.6, Number Of Rounds: 10, Local Epochs: 3
2024-11-11 09:13:12,352 INFO Dataset: resnet, Setting: 15 Bad Clients with 40.0% Mislabeled Samples Per Bad Client
2024-11-11 09:13:12,352 INFO Test Accuracy Before Retraining: 31.740000000000002%
2024-11-11 09:13:12,352 INFO Test Accuracy After Retraining: 44.46%
2024-11-11 09:13:12,352 INFO Bad Client Accuracy: 0.88
2024-11-11 09:13:12,352 INFO Banzhaf Values: defaultdict(<class 'float'>, {0: 0.16894797794520855, 7: 0.5625186430988833, 41: -0.6729639481927734, 17: 0.26329297517077066, 40: -0.38628330038045533, 42: -0.43643781973514706, 23: 0.2786510738078505, 48: -0.4441920186509378, 9: 0.24842358945170417, 21: 0.568798994179815, 35: -0.35014673694968224, 24: 0.4363152926089242, 2: 0.5309183386561926, 25: 0.30510818597394973, 27: 0.49448857153765857, 47: -0.41587394615635276, 4: 0.4061814150918508, 12: 0.29690775251947343, 6: -0.0024858318211045116, 22: 0.43282404029741883, 19: 0.31648531317478046, 5: 0.09042523798416369, 31: 0.33158912789076567, 46: -0.7145120961940847, 1: 0.32750947680324316, 3: 0.41757940442766994, 8: 0.18139792315196246, 14: 0.3422073135152459, 39: 0.07660597978974693, 37: 0.06197838007938117, 49: -0.2839832155732438, 30: 0.42356102821577224, 26: 0.24740395322442055, 28: 0.25060326216043904, 16: 0.16991630499251187, 36: -0.28224534483160824, 11: 0.03168832772644237, 38: -0.7310049652587622, 29: 0.24021497560897842, 44: -0.19614956981968135, 10: 0.4287191269977484, 18: 0.0814791306911502, 15: 0.25442468185792677, 20: 0.4510208005012828, 34: 0.27492336952127516, 45: -0.46539186498557683, 32: 0.07497805054299533, 43: -0.6595843109535053, 33: 0.3629098907113075, 13: -0.18951972015202045})
2024-11-11 09:13:12,352 INFO Predicted Bad Clients: [41, 40, 42, 48, 35, 47, 6, 5, 46, 39, 37, 49, 36, 11, 38, 44, 18, 45, 32, 43, 13] vs. Actual Bad Clients: [35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
2024-11-11 09:13:12,352 INFO Total Run Time: 1212.876200914383

2024-11-11 10:20:04,081 INFO Number Of Clients: 50, Fraction Of Clients Per Round: 0.6, Number Of Rounds: 50, Local Epochs: 3
2024-11-11 10:20:04,081 INFO Dataset: resnet, Setting: IID
2024-11-11 10:20:04,081 INFO Test Accuracy Before Retraining: 75.12%
2024-11-11 10:20:04,081 INFO Total Run Time: 3716.1198070049286
2024-11-11 13:44:57,456 INFO Number Of Clients: 50, Fraction Of Clients Per Round: 0.6, Number Of Rounds: 25, Local Epochs: 3
2024-11-11 13:44:57,456 INFO Dataset: resnet, Setting: 15 Bad Clients with 40.0% Mislabeled Samples Per Bad Client
2024-11-11 13:44:57,456 INFO Test Accuracy Before Retraining: 63.77%
2024-11-11 13:44:57,456 INFO Test Accuracy After Retraining: 68.82000000000001%
2024-11-11 13:44:57,456 INFO Bad Client Accuracy: 0.8
2024-11-11 13:44:57,456 INFO Total Run Time: 3135.3584599494934


CIFAR STUFF:
2024-11-13 11:50:00,261 INFO Number Of Clients: 5, Client Selection Fraction: 0.6, Local Epochs: 3, Batch Size: 64
2024-11-13 11:50:00,263 INFO Dataset: cifar, Setting: IID, Number Of Rounds: 10
2024-11-13 11:50:00,264 INFO Test Accuracy Of Global Model: 57.410000000000004%
2024-11-13 11:50:00,264 INFO Shapley Values: [17.508029326796525, 18.027182807525005, 17.7029164036115, 17.387845421830818, 16.612750033537548]
2024-11-13 11:50:00,265 INFO Banzhaf Values: [3.011672515422106, 3.3458607867360115, 3.2741998583078384, 2.882849309593439, 2.7869386225938797]
2024-11-13 11:50:00,265 INFO Approximate Banzhaf Values: [0.4079287238419056, 0.5269764289259911, 0.5256571359932423, 0.7782205753028393, 0.6508490443229675]
2024-11-13 11:53:47,961 INFO Number Of Clients: 5, Client Selection Fraction: 0.6, Local Epochs: 3, Batch Size: 256
2024-11-13 11:53:47,962 INFO Dataset: cifar, Setting: IID, Number Of Rounds: 10
2024-11-13 11:53:47,962 INFO Test Accuracy Of Global Model: 47.58%
2024-11-13 11:53:47,963 INFO Shapley Values: [14.25567728082339, 13.647731331984208, 15.095248697201413, 13.483715422948201, 14.340114144484202]
2024-11-13 11:53:47,963 INFO Banzhaf Values: [2.629385147243738, 2.239043351262808, 3.035311345010996, 2.201563250273466, 2.846530120819807]
2024-11-13 11:53:47,963 INFO Approximate Banzhaf Values: [0.4294334277510643, 0.3432529866695404, 0.4682450294494629, 0.5823734384030104, 0.5448191612958908]
2024-11-13 12:23:21,661 INFO Number Of Clients: 5, Client Selection Fraction: 0.6, Local Epochs: 3, Batch Size: 256
2024-11-13 12:23:21,662 INFO Dataset: cifar, Setting: IID, Number Of Rounds: 10
2024-11-13 12:23:21,663 INFO Test Accuracy Of Global Model: 48.69%
2024-11-13 12:23:21,663 INFO Shapley Values: [14.411021614074707, 14.333837860822674, 13.166966899236044, 14.082998041311901, 14.491910213232039]
2024-11-13 12:23:21,664 INFO Banzhaf Values: [2.576354119926691, 2.451489921659231, 1.8686884231865406, 2.4650989808142185, 2.396327819675207]
2024-11-13 12:23:21,664 INFO Approximate Banzhaf Values: [0.04647482484579086, 0.07652713432908058, 0.08926150351762772, 0.13474056720733643, 0.09263342283666136]
2024-11-13 12:23:21,667 INFO Pearson Correlation Between Shapley And Banzhaf Values: PearsonRResult(statistic=0.9287447854716703, pvalue=0.02258716451841901)
2024-11-13 12:23:21,668 INFO Spearman Correlation Between Shapley And Banzhaf Values: SignificanceResult(statistic=0.3, pvalue=0.6238376647810728)
2024-11-13 12:23:21,670 INFO Pearson Correlation Between Shapley And Approximate Banzhaf Values: PearsonRResult(statistic=-0.22792080013690644, pvalue=0.7123347020310259)
2024-11-13 12:23:21,671 INFO Spearman Correlation Between Shapley And Approximate Banzhaf Values: SignificanceResult(statistic=-0.19999999999999998, pvalue=0.747060078104662)
2024-11-13 13:28:54,490 INFO Number Of Clients: 5, Client Selection Fraction: 0.6, Local Epochs: 3, Batch Size: 256
2024-11-13 13:28:54,491 INFO Dataset: cifar, Setting: IID, Number Of Rounds: 50
2024-11-13 13:28:54,491 INFO Test Accuracy Of Global Model: 62.67%
2024-11-13 13:28:54,491 INFO Shapley Values: [19.96085647145907, 21.106052924195925, 20.011489996314054, 19.27839135030905, 19.532399812340724]
2024-11-13 13:28:54,492 INFO Banzhaf Values: [4.098865903913975, 4.4293744675815105, 3.7622185461223125, 3.6758244819939137, 3.6066518537700176]
2024-11-13 13:28:54,492 INFO Approximate Banzhaf Values: [0.18907596487551928, 0.23603124078363188, 0.28617245722562074, 0.322951681772247, 0.2811350313946605]
2024-11-13 13:28:54,494 INFO Pearson Correlation Between Shapley And Banzhaf Values: PearsonRResult(statistic=0.9091072804795864, pvalue=0.03244262878158316)
2024-11-13 13:28:54,496 INFO Spearman Correlation Between Shapley And Banzhaf Values: SignificanceResult(statistic=0.7999999999999999, pvalue=0.10408803866182788)
2024-11-13 13:28:54,497 INFO Pearson Correlation Between Shapley And Approximate Banzhaf Values: PearsonRResult(statistic=-0.5423383196435236, pvalue=0.3450017362129023)
2024-11-13 13:28:54,498 INFO Spearman Correlation Between Shapley And Approximate Banzhaf Values: SignificanceResult(statistic=-0.49999999999999994, pvalue=0.39100221895577053)
2024-11-13 14:56:34,116 INFO Number Of Clients: 8, Client Selection Fraction: 0.6, Local Epochs: 3, Batch Size: 128
2024-11-13 14:56:34,117 INFO Dataset: cifar, Setting: IID, Number Of Rounds: 10
2024-11-13 14:56:34,118 INFO Test Accuracy Of Global Model: 48.03%
2024-11-13 14:56:34,118 INFO Shapley Values: [8.979729959510633, 8.864531347581325, 8.808182590064549, 9.66007720090093, 8.902889581521354, 9.494947423253745, 8.641165906190878, 9.566828833307543]
2024-11-13 14:56:34,119 INFO Banzhaf Values: [0.7227194961160421, 0.7642406988888979, 0.7489415043964982, 0.8290616748854518, 0.684575061313808, 0.82290677446872, 0.7650831574574113, 0.7576249353587627]
2024-11-13 14:56:34,119 INFO Approximate Banzhaf Values: [0.061816532630473375, 0.043045607628300786, 0.06026961142197251, 0.02230350347235799, 0.05099592870101333, 0.02970390720292926, 0.05728296050801873, 0.06544323451817036]
2024-11-13 14:56:34,122 INFO Pearson Correlation Between Shapley And Banzhaf Values: PearsonRResult(statistic=0.6175862845396082, pvalue=0.10277844079127467)
2024-11-13 14:56:34,123 INFO Spearman Correlation Between Shapley And Banzhaf Values: SignificanceResult(statistic=0.30952380952380953, pvalue=0.4556448907375822)
2024-11-13 14:56:34,124 INFO Pearson Correlation Between Shapley And Approximate Banzhaf Values: PearsonRResult(statistic=-0.5144729545712355, pvalue=0.19206227387266003)
2024-11-13 14:56:34,126 INFO Spearman Correlation Between Shapley And Approximate Banzhaf Values: SignificanceResult(statistic=-0.2142857142857143, pvalue=0.6103444156452669)
2024-11-13 17:37:05,710 INFO Number Of Clients: 10, Client Selection Fraction: 0.6, Local Epochs: 5, Batch Size: 128
2024-11-13 17:37:05,711 INFO Dataset: cifar, Setting: IID, Number Of Rounds: 15
2024-11-13 17:37:05,712 INFO Test Accuracy Of Global Model: 42.22%
2024-11-13 17:37:05,712 INFO Shapley Values: [6.125405450756584, 6.146241366390202, 6.750093309368409, 6.194564120495123, 5.349738805492722, 6.345583060525716, 5.575076752617236, 6.234758542832866, 7.02992343164626, 5.931835307961415]
2024-11-13 17:37:05,712 INFO Banzhaf Values: [0.21535005478654057, 0.19984917936380953, 0.1957424854626879, 0.3183284067781642, 0.12296990596223623, 0.1443934104172513, 0.09243859176058322, 0.2604816824896261, 0.3530386845814064, 0.19796931196469814]
2024-11-13 17:37:05,713 INFO Approximate Banzhaf Values: [0.03085136217996478, 0.040994962025433776, 0.0307436890900135, 0.04094369644299149, 0.03954162746667862, 0.04876525141298771, 0.036769882123917345, 0.03603592151775956, 0.033165809512138364, 0.05057727936655283]
2024-11-13 17:37:05,715 INFO Pearson Correlation Between Shapley And Banzhaf Values: PearsonRResult(statistic=0.6923689888418414, pvalue=0.02649095918555544)
2024-11-13 17:37:05,716 INFO Spearman Correlation Between Shapley And Banzhaf Values: SignificanceResult(statistic=0.5393939393939393, pvalue=0.1075931877824148)
2024-11-13 17:37:05,717 INFO Pearson Correlation Between Shapley And Approximate Banzhaf Values: PearsonRResult(statistic=-0.3226629770907185, pvalue=0.3631826374299209)
2024-11-13 17:37:05,718 INFO Spearman Correlation Between Shapley And Approximate Banzhaf Values: SignificanceResult(statistic=-0.33333333333333326, pvalue=0.34659350708733405)


MOBILENET STUFF:
2024-11-13 15:28:13,019 INFO Number Of Clients: 5, Client Selection Fraction: 0.6, Local Epochs: 3, Batch Size: 256
2024-11-13 15:28:13,020 INFO Dataset: mobilenet, Setting: IID, Number Of Rounds: 30
2024-11-13 15:28:13,020 INFO Test Accuracy Of Global Model: 73.29%
2024-11-13 15:28:13,021 INFO Shapley Values: [24.612190292278928, 24.040030952294668, 24.62182369927565, 22.468360290924704, 25.15955013136069]
2024-11-13 15:28:13,021 INFO Banzhaf Values: [6.843448542058468, 6.321067288517952, 6.696817737072706, 6.327272951602936, 6.542531941086054]
2024-11-13 15:28:13,021 INFO Approximate Banzhaf Values: [0.31077867719577623, 0.36402533017098904, 0.29145101710892046, 0.33279594476989593, 0.19306844866805478]
2024-11-13 15:28:13,024 INFO Pearson Correlation Between Shapley And Banzhaf Values: PearsonRResult(statistic=0.6301071362526811, pvalue=0.25453445567211735)
2024-11-13 15:28:13,025 INFO Spearman Correlation Between Shapley And Banzhaf Values: SignificanceResult(statistic=0.49999999999999994, pvalue=0.39100221895577053)
2024-11-13 15:28:13,027 INFO Pearson Correlation Between Shapley And Approximate Banzhaf Values: PearsonRResult(statistic=-0.6295525562227242, pvalue=0.2550829171924289)
2024-11-13 15:28:13,028 INFO Spearman Correlation Between Shapley And Approximate Banzhaf Values: SignificanceResult(statistic=-0.8999999999999998, pvalue=0.03738607346849874)

FMNIST STUFF:
2024-11-17 13:18:37,777 INFO Number Of Clients: 50, Client Selection Fraction: 0.6, Local Epochs: 10
2024-11-17 13:18:37,778 INFO Batch Size: 32, Learning Rate: 0.01, Momentum: 0.9
2024-11-17 13:18:37,778 INFO Dataset: fmnist, Setting: IID, Number Of Rounds: 50
2024-11-17 13:18:37,779 INFO Test Accuracy Before Retraining: 90.36999999999999%
2024-11-17 13:18:37,779 INFO Banzhaf Values: defaultdict(<class 'float'>, {47: -0.02509267114510294, 6: -0.01754805715791008, 13: -0.020002841933091986, 45: -0.020450526386412093, 9: -0.02232645001822675, 35: -0.023683517531026155, 12: -0.01967605340882983, 23: -0.018450879118063312, 10: -0.014198637491062982, 20: -0.015347430419524244, 43: -0.023130544348987314, 3: -0.023820026554858487, 4: -0.02061706159656751, 37: -0.024964580588857643, 2: -0.022202727050171234, 8: -0.017078311459044926, 18: -0.02560985801392235, 15: -0.022568597964891524, 30: -0.0235317430528994, 46: -0.020133060963416938, 25: -0.018345707418120583, 31: -0.020783074593055062, 0: -0.01594261475474923, 39: -0.013149491028343618, 44: -0.02232769810507307, 34: -0.02687152026919648, 21: -0.019666426447656704, 40: -0.018610088403875125, 24: -0.017975850656512193, 16: -0.018440361443936126, 17: -0.008759925243793987, 48: -0.006313005767879076, 19: -0.009751897536261822, 49: -0.002678182219824521, 42: -0.006654445609456161, 7: -0.002579140658781398, 22: -0.006153176746920508, 28: -0.006769231453404245, 29: -0.006803351585404016, 1: -0.004403947070386494, 33: -0.004922490144508629, 32: -0.003835497494037554, 11: -0.007144084629544523, 5: -0.008637364529477054, 38: -0.006263071205466986, 26: -0.0036306743877503322, 14: -0.005605056507192785, 27: -0.00610772774052748, 36: -0.002194674581005529, 41: -0.0025847935685305856})
2024-11-17 13:18:37,780 INFO Actual Bad Clients: None
2024-11-17 13:18:37,780 INFO Predicted Bad Clients: [17, 48, 49, 42, 7, 22, 28, 29, 1, 33, 32, 11, 5, 38, 26, 14, 27, 36, 41]
2024-11-17 13:18:37,781 INFO Bad Client Accuracy: 0.0
2024-11-17 13:18:37,781 INFO Total Run Time: 496.32799792289734


SHAPLEY SITUATION:
| Global Round : 100 | Local Epoch : 3 | Loss: 0.537169
Shapley Permutations: 100%|█████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [19:11<00:00, 11.52s/it]
Training Epochs:  67%|███████████████████████████████████████████████████████████████████▎                                 | 4/6 [25:02<12:31, 375.56s/it]
Traceback (most recent call last):
  File "/workspace/FLPyTorch/src/robustness.py", line 247, in <module>
    global_model, approx_banzhaf_values_simple, approx_banzhaf_values_hvp, shapley_values, influence_values = train_global_model(args, global_model, train_dataset, test_dataset, user_groups, device)
  File "/workspace/FLPyTorch/src/robustness.py", line 196, in train_global_model
    influence = compute_influence_functions(args, model, train_dataset, user_groups, device, test_dataset)
  File "/workspace/FLPyTorch/src/robustness.py", line 122, in compute_influence_functions
    x = conjugate_gradient(model, train_dataset, test_loss_grad, num_iterations=20, tol=1e-4)
  File "/workspace/FLPyTorch/src/update.py", line 167, in conjugate_gradient
    x = torch.zeros_like(b).to(device)
TypeError: zeros_like(): argument 'input' (position 1) must be Tensor, not dict
